!function(){"use strict";angular.module("siurana.charts",["siurana.routes","ngRoute","ui.bootstrap"])}(),function(){"use strict";angular.module("siurana.core",["ngStorage"]),angular.module("siurana.core").config(["$httpProvider",function(a){a.interceptors.push("authInterceptor")}])}(),function(){"use strict";angular.module("siurana.map",["siurana.core","siurana.charts","siurana.routes","ngRoute","uiGmapgoogle-maps","ui.bootstrap"])}(),function(){"use strict";angular.module("siurana.routes",["siurana.core","siurana.users","hc.marked","jlareau.pnotify","ui.bootstrap","ngRoute","ngStorage"])}(),function(){"use strict";angular.module("siurana.table",["siurana.core","siurana.routes","siurana.charts","datatables","datatables.bootstrap","ngRoute","ui.bootstrap"])}(),function(){"use strict";angular.module("siurana.timeline",["siurana.core","siurana.routes","siurana.charts","ngRoute","angular-timeline","ui.bootstrap"])}(),function(){"use strict";angular.module("siurana.users",["siurana.core","jlareau.pnotify"])}(),function(){"use strict";function a(a,b){var c=this;c.initController=function(a){c.routes=_.toArray(a)},c.initController(b),a.subscribeForUpdates(c.initController)}angular.module("siurana.charts").controller("chartsCtrl",a),a.$inject=["RoutesSvc","ResolvedRoutes"]}(),function(){"use strict";function a(a,b,c,d){d.getRoutes().then(function(b){a.initController(b),d.subscribeForUpdates(a.initController)}),a.initController=function(b){var d=_.toArray(b),e=c.arrayGroupBy(d,"sector"),f=c.arrayGroupBy(d,"type");a.routes=d,a.metrics={count:d.length,favoriteSector:e[0],favoriteType:f[0]}}}angular.module("siurana.charts").controller("overviewCtrl",a),a.$inject=["$scope","$log","utilsChartSvc","RoutesSvc"]}(),function(){"use strict";function a(){return{templateUrl:"components/charts/views/_gridCharts.html",restrict:"E",scope:{routes:"="}}}angular.module("siurana.charts").directive("gridCharts",a),a.$inject=[]}(),function(){"use strict";function a(){return{scope:!0,restrict:"E",templateUrl:"components/charts/views/_headerOverview.html",controller:"overviewCtrl"}}angular.module("siurana.charts").directive("headerOverview",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c,d){var e=_.random(1e4,99999);return{scope:{routes:"=",width:"="},restrict:"E",template:'<div id="chart-'+e+'"></div>',link:function(f,g){function h(){f.renderChart(f.routes)}angular.element(b).bind("resize",function(){h()}),f.$watch("routes",function(a){f.renderChart(a)}),f.openSliderModal=function(b){a.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return b}}})},f.renderChart=function(a){a=a||[];var b=d.arrayGroupBy(a,"type"),h=b.length>0?b[0]:"Sport Lead",i=f.getHorizontalBar().data(c.processData(a,h)).width(f.width||g.parent().width()).height(300);d3.select(g.find("#chart-"+e)[0]).call(i)},f.getHorizontalBar=function(){function a(g){function h(){n={top:30,right:10,bottom:10,left:10},p=c-n.left-n.right,o=e-n.top-n.bottom}function i(){t=d3.max(b,function(a){return a.total})||0,r=d3.scale.linear().range([0,p]).domain([-t,t]),s=d3.scale.ordinal().rangeRoundBands([0,o],.1).domain(b.map(function(a){return a.grade})),q=d3.svg.axis().scale(r).tickFormat(function(a){return a%1===0?Math.abs(a):""}).orient("top")}function j(){g.select("svg").remove(),u=g.append("svg").attr("width",c).attr("height",e).append("g").attr("transform","translate("+n.left+","+n.top+")"),v=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var b="";return b+='<span style="color:'+d.typeColor(a.name)+'">',b+=a.name+"</span> ",b+=a.grade+" : <span style='color:red'>"+a.total+"</span>"}),u.call(v)}function k(){u.selectAll(".bar").data(b).enter().append("rect").attr("x",function(a){return r(-a.total)}).attr("y",function(a){return s(a.grade)}).attr("width",function(a){return r(a.total)-r(-a.total)}).attr("height",s.rangeBand()).style("fill",function(a){return d.typeColor(a.name)}).style("cursor","pointer").on("click",function(a){f.openSliderModal(a.routesId)}).on("mouseover",function(a){$(this).css({opacity:.8}),v.show(a)}).on("mouseout",function(a){$(this).css({opacity:1}),v.hide(a)})}function l(){u.append("g").attr("class","x axis").call(q),u.append("g").attr("class","y axis").append("line").attr("x1",r(0)).attr("x2",r(0)).attr("y2",o)}function m(){u.selectAll(".axis line, path").style({stroke:"Black",fill:"none","stroke-width":"1px","shape-rendering":"crispEdges"})}h(),i(),j(),k(),l(),m();var n,o,p,q,r,s,t,u,v;return a}var b=[],c=800,e=600;return a.data=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=0>=b?c:b,a):c},a.height=function(b){return arguments.length?(e=0>=b?e:b,a):e},a},h()}}}angular.module("siurana.charts").directive("horizontalBarChart",a),a.$inject=["$uibModal","$window","horizontalBarChartSvc","utilsChartSvc"]}(),function(){"use strict";function a(a,b,c){var d=_.random(1e4,99999);return{scope:{routes:"="},restrict:"E",template:'<div id="chart-'+d+'"></div>',link:function(e,f){function g(){e.renderChart(e.routes)}e.$watch("routes",function(a){e.renderChart(a)}),e.openSliderModal=function(b){a.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return b}}})},e.renderChart=function(a){a=a||[];var c=e.getCalendarHeatmap().data(b.processData(a)).cellSize(13);d3.select(f.find("#chart-"+d)[0]).call(c)},e.getCalendarHeatmap=function(){function a(a){function f(){o.selectAll(".emptyDay").style({fill:"#fff",stroke:"#ccc"}),o.selectAll("rect").style({"shape-rendering":"crispEdges"}),o.selectAll("text").style({font:"12px sans-serif",fill:"gray"})}function g(){o.append("text").attr("transform","translate(0,"+(2+8*d)+")").text("Summary of climbs over the last year");var a=515;o.append("text").attr("transform","translate("+a+","+(2+8*d)+")").text("Types of climbs");var b=["Sport lead","Boulder","Traditional","Multi-pitch","Top rope"];o.selectAll(".legendDay").data(b).enter().append("rect").attr("width",d).attr("height",d).attr("x",function(c){var e=b.indexOf(c);return a+90+d*e+2*e}).attr("y",8*d-8).style("fill",function(a){return c.typeColor(a)}).on("mouseover",function(a){$(this).css({opacity:.8}),q.show(a)}).on("mouseout",function(a){$(this).css({opacity:1}),q.hide(a)})}var h=d3.time.format("%w"),i=d3.time.format("%U"),j=d3.time.format("%m/%d/%Y");a.select("svg").remove();var k=new Date,l=new Date(k.getFullYear()-1,k.getMonth(),k.getDate()+1),m=54*d+10,n=8*d+10,o=a.append("svg").data([1]).attr("width",m).attr("height",n).attr("class","RdYlGn").append("g");o.append("text").attr("transform","translate(-6,"+3.5*d+")rotate(-90)").style("text-anchor","middle").text(function(a){return a});var p=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var d=b[a].metrics[0],e="";return e+='<span style="color:'+c.typeColor(d.type)+'">',e+=d.type+"</span> ",e+=d.grade+" "+d.status,e+=" <span style='color:gray'>"+a+"</span>"});o.call(p);var q=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){return'<span style="color:'+c.typeColor(a)+'">'+a+"</span>"});o.call(q);var r=o.selectAll(".emptyDay").data(function(){return d3.time.days(l,k)}).enter().append("rect").attr("class","emptyDay").attr("width",d).attr("height",d).attr("x",function(a){var b=k.getFullYear()===a.getFullYear()?1+parseInt(i(k))-parseInt(i(a)):53-parseInt(i(a))+parseInt(i(k));return(53-b)*d}).attr("y",function(a){return h(a)*d}).datum(j);r.filter(function(a){return a in b}).attr("class","climbDay").style("fill",function(a){return c.typeColor(b[a].metrics[0].type)}).style("cursor","pointer").on("click",function(a){e.openSliderModal(_.pluck(b[a].metrics,"id"))}).on("mouseover",function(a){$(this).css({opacity:.8}),p.show(a)}).on("mouseout",function(a){$(this).css({opacity:1}),p.hide(a)}),g(),f()}var b=[],d=13;return a.data=function(c){return arguments.length?(b=c,a):b},a.cellSize=function(b){return arguments.length?(d=b||d,a):d},a},g()}}}angular.module("siurana.charts").directive("overviewChart",a),a.$inject=["$uibModal","overviewChartSvc","utilsChartSvc"]}(),function(){"use strict";function a(a,b,c,d){var e=_.random(1e4,99999);return{scope:{routes:"=",width:"="},restrict:"E",template:'<div id="chart-'+e+'"></div>',link:function(f,g){function h(){f.renderChart(f.routes)}angular.element(b).bind("resize",function(){h()}),f.$watch("routes",function(a){f.renderChart(a)}),f.openSliderModal=function(b){a.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return b}}})},f.renderChart=function(a){a=a||[];var b=f.getScatterPlot().data(c.processData(a)).width(f.width||g.parent().width()).height(300);d3.select(g.find("#chart-"+e)[0]).call(b)},f.getScatterPlot=function(){function a(a){var g,h={top:20,right:20,bottom:55,left:30},i=c-h.left-h.right,j=e-h.top-h.bottom,k=d3.scale.linear().range([0,i]),l=d3.scale.linear().range([j,0]),m=d3.svg.axis().scale(k).orient("bottom").tickFormat(d3.format("d")),n=d3.svg.axis().scale(l).orient("left").tickFormat(d3.format("d"));a.select("svg").remove();var o=a.append("svg").attr("width",c).attr("height",e);g=o.append("g").attr("transform","translate("+h.left+","+h.top+")"),k.domain([0,d3.max(b,function(a){return a.totalRoutes})]),l.domain([0,5]);var p=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var b="";return b+='<span class="hidden-xs" style="color:',b+=d.typeColor(a.dominantType)+'">',b+=a.dominantType+"</span> ",b+=a.sector+" "+a.avgRating.toFixed(1)+' <i class="fa fa-star-o"></i>',b+=" : <span style='color:red'>"+a.totalRoutes+"</span>"});o.call(p),g.selectAll(".dot").data(b).enter().append("circle").attr("class","dot-usage").attr("r",10).attr("cx",function(a){return k(a.totalRoutes)}).attr("cy",function(a){return l(a.avgRating)}).style("fill",function(a){return d.typeColor(a.dominantType)}).style("cursor","pointer").on("click",function(a){f.openSliderModal(a.routesId)}).on("mouseover",function(a){$(this).css({opacity:.8}),p.show(a)}).on("mouseout",function(a){$(this).css({opacity:1}),p.hide(a)}),g.append("g").attr("class","y axis").call(n).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Average Rating"),g.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(m).append("text").attr("x",i).attr("y","-6").style("text-anchor","end").text("Total Routes"),o.selectAll(".axis line, .axis path").style({stroke:"Black",fill:"none","stroke-width":"1px","shape-rendering":"crispEdges"})}var b=[],c=800,e=600;return a.data=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=0>=b?c:b,a):c},a.height=function(b){return arguments.length?(e=0>=b?e:b,a):e},a},h()}}}angular.module("siurana.charts").directive("scatterPlotChart",a),a.$inject=["$uibModal","$window","scatterPlotChartSvc","utilsChartSvc"]}(),function(){"use strict";function a(){return{templateUrl:"components/charts/views/_sectorsMetrics.html",restrict:"E",scope:{metrics:"="},controller:function(a,b){a.openRoutesModal=function(a){b.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return a}}})}}}}angular.module("siurana.charts").directive("sectorsMetrics",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c){return{templateUrl:"components/charts/views/_sliderCharts.html",restrict:"E",scope:{routes:"="},link:function(b,d){b.slides=[{title:"Sector quality",type:"scatter-plot-chart",icon:"fa-star-o"},{title:"Climb quantity",type:"vertical-bar-chart",icon:"fa-bar-chart"},{title:"Favorite climb type difficulty",type:"horizontal-bar-chart",icon:"fa-bar-chart"},{title:"Climb diversity",type:"treemap-chart",icon:"fa-th-large"}],b.renderChart=function(){var c=b.currentSlideType;b.width=d.parent().width();var e="<"+c+' routes="routes" width="width"></'+c+">";d.find(".chart-"+c).empty().append(e),a(d.find(c))(b)},b.currentSlideType="",b.$watch(function(){return _.find(b.slides,function(a){return a.active})},function(a,d){a!==d&&(b.currentSlideType=a.type,c(b.renderChart,10))})}}}angular.module("siurana.charts").directive("sliderCharts",a),a.$inject=["$compile","$rootScope","$timeout"]}(),function(){"use strict";function a(a,b,c,d){var e=_.random(1e4,99999);return{scope:{routes:"=",width:"="},restrict:"E",template:'<div id="chart-'+e+'"></div>',link:function(f,g,h){function i(){f.renderChart(f.routes)}angular.element(a).bind("resize",function(){i()}),f.$watch("routes",function(a){f.renderChart(a)}),f.openSliderModal=function(a){b.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return a}}})},f.renderChart=function(a){a=a||[];var b=f.getTreemap().data(c.processData(a)).width(f.width||g.parent().width()).height(300);d3.select(g.find("#chart-"+e)[0]).call(b)},f.getTreemap=function(){function a(a){function g(){l=c,m=e,n=d3.scale.linear().range([0,l]),o=d3.scale.linear().range([0,m]),q=p=b}function h(){r=d3.layout.treemap().round(!1).size([l,m]).sticky(!0).value(function(a){return a.count}),a.select("div").remove(),s=a.append("div").attr("class","chart").style("width",l+"px").style("height",m+"px").append("svg:svg").attr("width",l).attr("height",m).append("svg:g").attr("transform","translate(.5,.5)"),t=d3.tip().attr("class","d3-tip hidden-xs").offset([-10,0]).html(function(a){var b="",c=a.parent?a.parent.name:"";return b+='<span style="color:'+d.typeColor(c)+'">',b+=c+"</span> ",b+=a.name+": <span style='color:red'>"+a.count+"</span>"}),u=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var b="";return b+=a.name+": <span style='color:red'>"+a.count+"</span>"}),s.call(u),s.call(t)}function i(){var a=r.nodes(p).filter(function(a){return!a.children}),b=s.selectAll("g").data(a).enter().append("svg:g").attr("class","cell").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});b.append("svg:rect").attr("width",function(a){return Math.max(a.dx-1,0)}).attr("height",function(a){return Math.max(a.dy-1,0)}).on("click",function(a){return k(q==a.parent?p:a.parent)}).style("fill",function(a){return a.parent?d.typeColor(a.parent.name):"#f5f5f5"}).on("mouseover",function(a){a.children||($(this).css({opacity:.8}),u.show(a))}).on("mouseout",function(a){a.children||($(this).css({opacity:1}),u.hide(a))}),b.append("svg:text").attr("x",function(a){return a.dx/2}).attr("y",function(a){return a.dy/2}).attr("dy",".35em").attr("text-anchor","middle").text(function(a){return a.name}).style("opacity",function(a){return a.w=this.getComputedTextLength(),a.dx>a.w?1:0}).on("click",function(a){f.openSliderModal(a.routesId)}).on("mouseover",function(a){a.children||t.show(a)}).on("mouseout",function(a){a.children||t.hide(a)})}function j(){s.selectAll("text").style({cursor:"pointer"}),s.selectAll("rect").style({cursor:"pointer"})}function k(a){var b=l/a.dx,c=m/a.dy;n.domain([a.x,a.x+a.dx]),o.domain([a.y,a.y+a.dy]);var d=s.selectAll("g.cell").transition().duration(d3.event.altKey?7500:750).attr("transform",function(a){return"translate("+n(a.x)+","+o(a.y)+")"});d.select("rect").attr("width",function(a){return Math.max(b*a.dx-1,0)}).attr("height",function(a){return Math.max(c*a.dy-1,0)}),d.select("text").attr("x",function(a){return b*a.dx/2}).attr("y",function(a){return c*a.dy/2}).style("opacity",function(a){return b*a.dx>a.w?1:0}),q=a,d3.event.stopPropagation()}var l,m,n,o,p,q,r,s,t,u;g(),h(),i(),j()}var b=[],c=800,e=600;return a.data=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=0>=b?c:b,a):c},a.height=function(b){return arguments.length?(e=0>=b?e:b,a):e},a},i()}}}angular.module("siurana.charts").directive("treemapChart",a),a.$inject=["$window","$uibModal","treemapChartSvc","utilsChartSvc"]}(),function(){"use strict";function a(a,b,c,d){var e=_.random(1e4,99999);return{scope:{routes:"=",width:"="},restrict:"E",template:'<div id="chart-'+e+'"></div>',link:function(f,g){function h(){f.renderChart(f.routes)}angular.element(b).bind("resize",function(){h()}),f.$watch("routes",function(a){f.renderChart(a)}),f.openSliderModal=function(b){a.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return b}}})},f.renderChart=function(a){a=a||[];var b=f.getVerticalBar().data(c.processData(a)).width(f.width||g.parent().width()).height(300);d3.select(g.find("#chart-"+e)[0]).call(b)},f.getVerticalBar=function(){function a(g){var h={top:20,right:20,bottom:55,left:30},i=c-h.left-h.right,j=e-h.top-h.bottom,k=d3.scale.ordinal().rangeRoundBands([0,i],.1),l=d3.scale.linear().rangeRound([j,0]),m=function(a){var b=[];return b[1]="Jan",b[2]="Feb",b[3]="Mar",b[4]="Apr",b[5]="May",b[6]="Jun",b[7]="Jul",b[8]="Aug",b[9]="Sep",b[10]="Oct",b[11]="Nov",b[12]="Dec",b[parseInt(a)]},n=d3.svg.axis().scale(k).orient("bottom"),o=d3.svg.axis().scale(l).orient("left").tickFormat(d3.format("d"));g.select("svg").remove();var p=g.append("svg").attr("width",c).attr("height",e).append("g").attr("transform","translate("+h.left+","+h.top+")"),q=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(a){var b="";return b+='<span style="color:'+d.typeColor(a.name)+'">',b+=a.name+"</span> ",b+=" : <span style='color:red'>"+a.sum+"</span>"});p.call(q);var r,s=0;for(r=0;r<b.length;r++){for(var t=b[r],u=0,v=0;v<t.type.length;v++)u+=t.type[v].sum;s=Math.max(s,u)}var w=new Date,x=[];for(r=0;12>r;r++){var y=String(w.getMonth()+1)+String(w.getFullYear());y=w.getMonth()<9?"0"+y:y,x.push(y),w.setMonth(w.getMonth()-1)}k.domain(x.reverse()),l.domain([0,s]),p.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(n).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-65)").text(function(a){var b=a.substr(0,2),c=a.substr(4,6);return m(b)+"-"+c}),p.append("g").attr("class","y axis").call(o).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Climbs");var z=p.selectAll(".date").data(b).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+k(a.date)+",0)"});return z.selectAll("rect").data(function(a){return a.type}).enter().append("rect").attr("width",k.rangeBand()).attr("y",function(a){return l(a.y1)}).attr("height",function(a){return l(a.y0)-l(a.y1)}).style("fill",function(a){return d.typeColor(a.name)}).style("cursor","pointer").on("click",function(a){f.openSliderModal(a.routesId)}).on("mouseover",function(a){$(this).css({opacity:.8}),q.show(a)}).on("mouseout",function(a){$(this).css({opacity:1}),q.hide(a)}),p.selectAll(".axis line, .axis path").style({stroke:"Black",fill:"none","stroke-width":"1px","shape-rendering":"crispEdges"}),a}var b=[],c=800,e=600;return a.data=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(c=0>=b?c:b,a):c},a.height=function(b){return arguments.length?(e=0>=b?e:b,a):e},a},h()}}}angular.module("siurana.charts").directive("verticalBarChart",a),a.$inject=["$uibModal","$window","verticalBarChartSvc","utilsChartSvc"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b,c){b=b.filter(function(a){return a.type===c});var d=a.arrayToHashtable(b,"grade"),e=[];return _.forOwn(d,function(a,b){e.push({name:c,grade:b,total:a.length,routesId:_.pluck(a,"id")})}),e=e.sort(function(b,c){return a.compareRouteGrade(b.grade,c.grade)})},b}angular.module("siurana.charts").service("horizontalBarChartSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b){var c,d=a.arrayToHashtable(b,"date"),e=a.arrayToHashtable(b,"type"),f=[];c=function(b,c){return!a.compareRouteGrade(b,c)},_.forOwn(e,function(b,d){f[d]=a.arrayGroupBy(b,"grade").sort(c)});var g={};return c=function(b,c){return!a.compareRouteGrade(b.grade,c.grade)},_.forOwn(d,function(b,h){var i=[],j=a.arrayToHashtable(b,"type");_.forOwn(j,function(a,b){a.sort(c);var d=a[0],g=f[d.type].indexOf(d.grade),h=Math.abs(parseFloat(g)/e[b].length);d.grade||(d.grade=""),i.push({id:d.id,type:d.type,grade:d.grade,status:d.status,ease:h,count:j[b].length})}),i.sort(function(a,b){return a.count<b.count}),g[h]={date:h,total:d[h].length,metrics:i}}),g},b}angular.module("siurana.charts").service("overviewChartSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b){var c=a.arrayToHashtable(b,"sector"),d=[];return _.forOwn(c,function(b,c){for(var e=a.arrayGroupBy(b,"type"),f=0,g=0;g<b.length;g++)f+=parseInt(b[g].rating)||0;var h=parseFloat(f)/b.length;d.push({sector:c,avgRating:h,dominantType:e[0],totalRoutes:b.length,routesId:_.pluck(b,"id")})}),d},b}angular.module("siurana.charts").service("scatterPlotChartSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b){var c=[];_.mapKeys(a.arrayToHashtable(b,"type"),function(b,d){var e=[];_.mapKeys(a.arrayToHashtable(b,"location"),function(a,b){e.push({name:b,count:a.length,routesId:_.pluck(a,"id")})}),c.push({name:d,children:e})});var d={};return d.name="Climbs",d.children=c,d},b}angular.module("siurana.charts").service("treemapChartSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a){var b={};return b.arrayGroupBy=function(a,b){var c={},d={};return a.map(function(a){if(a.hasOwnProperty(b)){var c=a[b];return d.hasOwnProperty(c)||(d[c]=0),d[c]+=1,c}}).sort(function(a,b){return d[a]<d[b]}).filter(function(a){return c.hasOwnProperty(a)||void 0===a?!1:c[a]=!0})},b.typeColor=function(b){var c={type:b};return a.getTypeColor(c)},b.arrayToHashtable=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d][b];"undefined"==typeof c[e]&&(c[e]=[]),c[e].push(a[d])}return c},b.compareRouteGrade=function(a,b){var c=parseInt(a.replace(/\D/g,"")),d=parseInt(b.replace(/\D/g,"")),e=a.replace(/[0-9]/g,"").toLowerCase(),f=b.replace(/[0-9]/g,"").toLowerCase();return c>d||c===d&&e>f},b}angular.module("siurana.charts").service("utilsChartSvc",a),a.$inject=["RoutesUtilsSvc"]}(),function(){"use strict";function a(){var a={};return a.processData=function(a){a=a.filter(function(a){return moment().diff(moment(a.date,"MM-DD-YYYY"),"months")<12});for(var b,c,d=[],e=0;e<a.length;e++){var f=a[e],g=f.date.split("/");c=g[0]+g[2],c in d||(d[c]={date:c,type:[]}),b=d[c],f.type in b.type||(b.type[f.type]={name:f.type,sum:0,y0:0,y1:0,routesId:[]}),b.type[f.type].sum+=1,b.type[f.type].routesId.push(f.id)}for(c in d){b=d[c];var h=0;for(var i in b.type){var j=b.type[i];j.y0=h,h+=j.sum,j.y1=h}}var k=[];return k=Object.keys(d).map(function(a){var b=d[a];return b.type=Object.keys(b.type).map(function(a){return b.type[a]}),b})},a}angular.module("siurana.charts").service("verticalBarChartSvc",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c){a.isActive=function(a){return a===b.path()},a.isLoggedIn=c.isLoggedIn}angular.module("siurana.core").controller("navbarCtrl",a),a.$inject=["$scope","$location","Auth"]}(),function(){angular.module("siurana.core").constant("APP_CONFIG",{protocol:"https",dns:"test-climbing-memo.firebaseio.com",version:"v1",url:"https://test-climbing-memo.firebaseio.com/v1/"})}(),function(){"use strict";function a(a,b,c){a.$on("$routeChangeStart",function(a){c.isLoggedIn()||"/"===b.url()||(a.preventDefault(),b.path("/"))})}angular.module("siurana.core").run(a),a.$inject=["$rootScope","$location","Auth"]}(),function(){"use strict";function a(){return{restrict:"E",replace:!0,templateUrl:"components/core/views/_mainNavbar.html",controller:"navbarCtrl"}}angular.module("siurana.core").directive("mainNavbar",a),a.$inject=[]}(),function(){"use strict";function a(a){return function(b,c){var d=a.parseHref(b);if(!d)return _.trunc(b,c);c=c||Number.MAX_VALUE;var e=d.host+d.pathname+(d.search||"");return e=e.replace(/^www\./,""),_.trunc(e,c)}}angular.module("siurana.core").filter("prettyUrl",a),a.$inject=["Utils"]}(),function(){"use strict";function a(a){var b={};return b.cachedSession=!1,b.createSession=function(c){b.cachedSession=c,a.mySession=c},b.deleteSession=function(){b.cachedSession=!1,delete a.mySession},b.getSession=function(){return b.cachedSession||(b.cachedSession=a.mySession||{}),b.cachedSession},b.isLoggedIn=function(){var a=b.getSession(),c=(new Date).getTime()/1e3;return a.token&&a.expires>c},b.getToken=function(){return b.isLoggedIn()?b.getSession().token:!1},b}angular.module("siurana.core").service("Auth",a),a.$inject=["$localStorage"]}(),function(){"use strict";function a(a,b,c,d){var e={};return e.request=function(a){if(0===a.url.indexOf(d.url)&&c.getToken()){var b=-1===a.url.indexOf("?")?"?":"&";a.url+=b+"auth="+c.getToken()}return a},e.responseError=function(c){return 401===c.status&&"/"!==b.url()&&b.path("/"),a.reject(c)},e}angular.module("siurana.core").service("authInterceptor",a),a.$inject=["$q","$location","Auth","APP_CONFIG"]}(),function(){"use strict";function a(){var a={};return a.parseHref=function(a){if(!_.isString(a))return!1;var b=a.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);return b&&{protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],search:b[6],hash:b[7]}},a}angular.module("siurana.core").service("Utils",a),a.$inject=[]}(),function(){"use strict";angular.module("siurana.map").config(function(a){a.configure({v:"3.17",libraries:"weather,geometry,visualization"})})}(),function(){"use strict";function a(a,b,c,d,e){var f=this;f.initController=function(a){f.offline=!b.online;var d=_.toArray(a),e=c.processData(d);_.map(e,function(a){return a.options={icon:"images/"+f.getMarkerIcon(a.metrics[0].type)},a}),f.locations=e,f.map={center:_.last(e).coords,zoom:8}},f.getMarkerIcon=function(a){var b="";switch(a){case"Sport lead":b="climbing_yellow.png";break;case"Boulder":b="climbing_blue.png";break;case"Traditional":b="climbing_green.png";break;case"Multi-pitch":b="climbing_orange.png";break;case"Top rope":b="climbing_gray.png";break;default:b="climbing_gray.png"}return b},f.initController(e),d.subscribeForUpdates(f.initController)}angular.module("siurana.map").controller("mapCtrl",a),a.$inject=["$log","$rootScope","mapChartSvc","RoutesSvc","ResolvedRoutes"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b){var c=a.arrayToHashtable(b,"location"),d=[];return _.forOwn(c,function(b,c){var e=[],f=a.arrayToHashtable(b,"sector");_.forOwn(f,function(b,c){e.push({sector:c,routesId:_.pluck(b,"id"),count:b.length,type:a.arrayGroupBy(b,"type")[0],rating:(_.reduce(b,function(a,b){return a+=b.rating||0},0)/b.length).toFixed(1)})}),e.sort(function(a,b){return a.count<b.count}),d.push({name:c,coords:{latitude:b[0].latitude,longitude:b[0].longitude},metrics:e})}),d},b}angular.module("siurana.map").service("mapChartSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a,b,c,d,e){b.cancelEdit=function(){b.route.$editMode=!1,a.dismiss("cancel")},b.flipCard=function(){b.route.$hover=!b.route.$hover},b.saveRoute=function(){b.route.$editMode=!1,e.saveRoute(b.route),b.cancelEdit()},b.initController=function(){var a={};a.notes=d(),a.$date=new Date,a.$editMode=!0,a.status="Attempt",b.route=a},b.initController()}angular.module("siurana.routes").controller("ModaladdrouteCtrl",a),a.$inject=["$uibModalInstance","$scope","$log","routeNoteFormattingFilter","RoutesSvc"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){a.closeModal=function(){b.dismiss("cancel")},i.getRoutes().then(function(b){a.initController(b)}),a.initController=function(b){var c=_.map(g,function(a){return _.find(b,function(b){return b.id===a})});a.myInterval=0,a.noWrapSlides=!1,a.slides=_.map(c,function(a){return a.notes=h(a.notes),{content:a}})},a.editRoute=function(a){a.$copy=_.clone(a),a.$date=new Date(a.date),a.$editMode=!0},a.deleteRoute=function(b){b.$editMode=!1,i.deleteRoute(b),a.closeModal()},a.saveRoute=function(a){a.$editMode=!1,i.saveRoute(a)},a.cancelEdit=function(a){a=_.merge(a,a.$copy),a.$editMode=!1,delete a.$copy},a.flipCard=function(){var b=_.first(a.slides.filter(function(a){return a.active}));b.$hover=!b.$hover}}angular.module("siurana.routes").controller("ModalsliderCtrl",a),a.$inject=["$scope","$uibModalInstance","$localStorage","$log","$rootScope","$filter","routesId","routeNoteFormattingFilter","RoutesSvc"]}(),function(){"use strict";function a(){return{restrict:"E",templateUrl:"components/routes/views/_cardRoute.html",link:function(a){a.tabs=[{icon:"sticky-note",text:"Notes",type:"notes"},{icon:"camera",text:"Media",type:"media"},{icon:"calendar",text:"Ascents",type:"ascents"},{icon:"cubes",text:"Builder",type:"builder"}]}}}angular.module("siurana.routes").directive("cardRoute",a),a.$inject=[]}(),function(){"use strict";function a(){return{restrict:"E",scope:{route:"="},templateUrl:"components/routes/views/_routeAscents.html"}}angular.module("siurana.routes").directive("routeAscents",a),a.$inject=[]}(),function(){"use strict";function a(){return{restrict:"E",scope:{route:"="},templateUrl:"components/routes/views/_routeBuilder.html"}}angular.module("siurana.routes").directive("routeBuilder",a),a.$inject=[]}(),function(){"use strict";angular.module("siurana.routes").directive("routeLocation",function(a,b){return{require:"ngModel",link:function(c,d,e,f){c.validateLocation=function(c){var d=a.defer(),e="https://maps.googleapis.com/maps/api/geocode/json?address=";return f.$isEmpty(c)?a.when():(b.get(e+encodeURIComponent(c)).then(function(a){"ZERO_RESULTS"!==a.data.status?d.resolve():d.reject()})["catch"](function(){d.resolve()}),d.promise)},f.$asyncValidators.routeLocation=c.validateLocation}}})}(),function(){"use strict";function a(a,b){return{restrict:"E",scope:{route:"="},templateUrl:"components/routes/views/_routeMedia.html",link:function(c){c.getMedia=b.getRouteMedia,c.isValidMedia=b.isValidRouteMedia,c.openMedia=function(b){a.open(b.link,"_blank")},c.deleteMedia=function(a){c.route.medias=_.filter(c.route.medias,function(b){return b!==a}),c.medias=_.filter(c.medias,function(b){return b.link!==a})},c.route=c.route||{},c.route.medias=c.route.medias||[],c.medias=_.map(c.route.medias,b.getRouteMedia),c.getMedia=b.getRouteMedia,c.newMedias=[""],c.$watch("newMedias",function(a){var d=_.filter(a,b.isValidRouteMedia);c.route.medias=_.pluck(c.medias,"link"),c.route.medias=_.union(d,c.route.medias),a.length===d.length&&c.newMedias.push("")},!0)}}}angular.module("siurana.routes").directive("routeMedia",a),a.$inject=["$window","RoutesUtilsSvc"]}(),function(){"use strict";function a(){return{restrict:"E",scope:{route:"="},templateUrl:"components/routes/views/_routeNotes.html"}}angular.module("siurana.routes").directive("routeNotes",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c){return{restrict:"E",scope:{route:"="},templateUrl:"components/routes/views/_routeSummary.html",link:function(d){d.getIconStatus=a.getIconStatus,d.getIconRock=a.getIconRock,d.getIndoorLabel=a.getIndoorLabel,d.getTypeColor=a.getTypeColor,d.getTimes=function(a){return new Array(a||0)},d.sectorPopulatePlaceholder=function(){for(var a=d.arrayRoutes.filter(function(a){return a.sector===d.route.sector}),b=["type","rock","location"],e=0;e<b.length;e++){var f=b[e];d.route.hasOwnProperty(f)||(d.route[f]=c.arrayGroupBy(a,f)[0])}},d.arrayRoutes=[],b.getRoutes().then(function(a){d.arrayRoutes=_.toArray(a),d.locations=c.arrayGroupBy(d.arrayRoutes,"location"),d.sectors=c.arrayGroupBy(d.arrayRoutes,"sector")})}}}angular.module("siurana.routes").directive("routeSummary",a),a.$inject=["RoutesUtilsSvc","RoutesSvc","utilsChartSvc"]}(),function(){"use strict";function a(){return function(a){return a?a:"**Notes:**\n\n---\n"}}angular.module("siurana.routes").filter("routeNoteFormatting",a),a.$inject=[]}(),function(){"use strict";angular.module("siurana.routes").constant("DATABASE_URL","https://climbing-memo.firebaseio.com/")}(),function(){
"use strict";function a(a,b,c,d){var e={};return e.subscribeForUpdates=d.addListener,e.getRoutes=function(){return c.getRoutes()},e.saveRoute=function(d){var e=a.defer();return c.saveRoute(d).then(function(a){b.success(a.name+" saved"),e.resolve(a)})["catch"](function(a){b.info('Offline mode: "'+a+'" event saved'),e.reject(!1)}),e.promise},e.deleteRoute=function(d){var e=a.defer();return c.deleteRoute(d).then(function(a){b.success(a.name+" deleted"),e.resolve(a)})["catch"](function(){b.info('Offline mode: "delete" event saved'),e.reject(!1)}),e.promise},e}angular.module("siurana.routes").service("RoutesSvc",a),a.$inject=["$q","notificationService","RoutesSyncSvc","RoutesCache"]}(),function(){"use strict";function a(){var a={};return a.data=null,a.listeners=[],a.getData=function(){return a.data},a.publishUpdate=function(){_.forEach(a.listeners,function(b){b(a.data)})},a.setData=function(b,c){c?(a.data=a.data||{},a.data[c]=b):a.data=b,a.publishUpdate()},a.removeData=function(b){a.data&&(delete a.data[b],a.publishUpdate())},a.addListener=function(b){a.listeners.push(b)},a}angular.module("siurana.routes").service("RoutesCache",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c){var d={};return d.getUrl=function(a){var d=b.getSession();return c.url+"users/"+d.uid+"/routes/"+a},d.cleanObjectProperties=function(a){var b=JSON.parse(JSON.stringify(a));return _.keys(b).filter(function(a){return a.match(/^\$/)}).forEach(function(a){delete b[a]}),b},d.getRoute=function(b){return a.get(d.getUrl(b+".json"))},d.getRoutes=function(){return a.get(d.getUrl(".json"))},d.addRoute=function(b){var c=d.cleanObjectProperties(b);return a.post(d.getUrl(".json"),c)},d.deleteRoute=function(b){return a["delete"](d.getUrl(b+".json"))},d.updateRoute=function(b,c){var e=d.cleanObjectProperties(b);return a.patch(d.getUrl(c+".json"),e)},d}angular.module("siurana.routes").service("RoutesPersistSvc",a),a.$inject=["$http","Auth","APP_CONFIG"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){var j={};j.getRoutes=function(a){var b=c.defer();return i.getData()&&!a?b.resolve(i.getData()):h.getRoutes().then(function(a){j.syncRoutes();var c=a.data||{};d.routes=c,i.setData(c),b.resolve(c)})["catch"](function(){a&&g.log("Offline mode: can't refresh routes"),g.log("Local Storage used - routes"),i.setData(d.routes),b.resolve(d.routes||[]),_.find(d.routes,function(a){return angular.isDefined(a.$sync)})&&j.createTimeout()}),b.promise},j.createRoute=function(a,b){h.addRoute(a).then(function(c){a.id=c.data.name,h.updateRoute(a,a.id),i.setData(h.cleanObjectProperties(a),a.id),b.resolve(a)})["catch"](function(){j.createRouteSync("create",a),b.reject("create")})},j.updateRoute=function(a,b){h.updateRoute(a,a.id).then(function(){i.setData(h.cleanObjectProperties(a),a.id),b.resolve(a)})["catch"](function(){j.createRouteSync("update",a),b.reject("update")})},j.saveRoute=function(d){var e=c.defer(),f=JSON.parse(JSON.stringify(d));f.date=a("date")(f.$date,"MM/dd/yyyy");var g="https://maps.googleapis.com/maps/api/geocode/json?address=";return b.get(g+encodeURIComponent(f.location)).then(function(a){var b=a.data;"ZERO_RESULTS"!==b.status&&(f.latitude=b.results[0].geometry.location.lat,f.longitude=b.results[0].geometry.location.lng),f.id?j.updateRoute(f,e):j.createRoute(f,e)})["catch"](function(){var a=f.id?"update":"create";j.createRouteSync(a,f),e.reject(a)}),e.promise},j.deleteRoute=function(a){var b=c.defer();return h.deleteRoute(a.id).then(function(){i.removeData(a.id),b.resolve(a)})["catch"](function(){j.createRouteSync("delete",a),b.reject(!1)}),b.promise};var k=3e4,l=!0;return j.createRouteSync=function(a,b){var c=!1;d.routes=_.map(d.routes,function(d){return b.id===d.id&&(c=!0,d.$sync=a,j.createTimeout()),d}),c||"delete"===a||(b.$sync=a,b.id="tmp_"+_.random(1e4,99999),d.routes.push(b),i.setData(b,b.id),j.createTimeout())},j.syncRoutes=function(){e.online?(l=!0,_.each(d.routes,function(a){switch(a.$sync){case"create":case"update":var b=a.id;a.id&&a.id.match(/^tmp/g)&&(a.id=!1),j.saveRoute(a).then(function(b){k=3e4,delete a.$sync})["catch"](function(){a.id=b});break;case"delete":j.deleteRoute(a).then(function(b){k=3e4,delete a.$sync})}})):_.find(d.routes,function(a){return angular.isDefined(a.$sync)})&&j.createTimeout()},j.createTimeout=function(){l&&(l=!1,f(j.syncRoutes,k),k*=2)},j}angular.module("siurana.routes").service("RoutesSyncSvc",a),a.$inject=["$filter","$http","$q","$localStorage","$rootScope","$timeout","$log","RoutesPersistSvc","RoutesCache"]}(),function(){"use strict";function a(a){var b={};return b.getIconStatus=function(a){return a&&a.status?"Attempt"===a.status?"fa-square-o":"fa-check-square-o":"fa-connectdevelop"},b.getIconRock=function(a){return a&&a.rock?"Indoor"===a.rock?"fa-home":"fa-sun-o":"fa-connectdevelop"},b.getIndoorLabel=function(a){return"Indoor"===a.rock?"Indoor":"Outdoor"},b.getTypeColor=function(a){switch(a.type){case"Sport lead":return"gold";case"Boulder":return"lightskyblue";case"Traditional":return"yellowgreen";case"Multi-pitch":return"darkorange";case"Top rope":return"lightgray";default:return"lightgray"}},b.getRouteMedia=function(b){var c={provider:"question-circle",color:"text-muted",link:b},d=a.parseHref(b);if(!d)return c;var e=d.hostname;return _.contains(e,"youtube")?(c.provider="youtube",c.color="text-danger",c.header="Youtube video"):_.contains(e,"instagram")?(c.provider="instagram",c.color="text-primary",c.header="Instagram photo"):_.contains(e,"vimeo")?(c.provider="vimeo",c.color="text-success",c.header="Vimeo video"):_.contains(e,"flickr")&&(c.provider="flickr",c.color="",c.header="Flickr photos"),c},b.isValidRouteMedia=function(a){return"question-circle"!==b.getRouteMedia(a).provider},b}angular.module("siurana.routes").service("RoutesUtilsSvc",a),a.$inject=["Utils"]}(),function(){"use strict";function a(){return{templateUrl:"components/table/views/_routesTable.html",restrict:"E"}}angular.module("siurana.table").directive("routesTable",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c,d,e,f){var g=this;g.dtInstance={},g.dtOptions=d.newOptions().withBootstrap().withOption("sDom","<'no-row'<'col-xs-4 hidden-xs'l><'col-xs-8'f>r>t<'no-row'<'col-xs-4 hidden-xs'i><'pull-righ'p>>").withOption("oLanguage",{sLengthMenu:'<i class="fa hidden-xs fa-eye"></i> _MENU_',sSearch:'<i class="fa hidden-xs fa-search"></i>',sSearchPlaceholder:"Filter routes",sEmptyTable:"No climbing routes found",oPaginate:{sNext:'<i class="fa fa-angle-right"></i>',sPrevious:'<i class="fa fa-angle-left"></i>'}}).withOption("pageLength",6).withOption("lengthMenu",[6,10,25,50,100]),g.nextPage=function(){var a=$(g.dtInstance.dataTable[0]).dataTable().api();a.page("next").draw("page")},g.previousPage=function(){var a=$(g.dtInstance.dataTable[0]).dataTable().api();a.page("previous").draw("page")},g.initController=function(a){var c=0;_.map(a,function(a,b){a.$date=a.date,a.$id=b,c++}),g.routes=_.toArray(a);var d=b.arrayGroupBy(g.routes,"location"),e=b.arrayGroupBy(g.routes,"sector");g.locations=d,g.sectors=e},g.getTypeColor=e.getTypeColor,g.getIconStatus=e.getIconStatus,g.addRoute=function(){a.open({templateUrl:"components/routes/views/_modalAddRoute.html",controller:"ModaladdrouteCtrl",size:"md"})},g.openRouteModal=function(b){a.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){return[b.id]}}})},g.initController(f),c.subscribeForUpdates(g.initController)}angular.module("siurana.table").controller("tableCtrl",a),a.$inject=["$uibModal","utilsChartSvc","RoutesSvc","DTOptionsBuilder","RoutesUtilsSvc","ResolvedRoutes"]}(),function(){"use strict";function a(){return{templateUrl:"components/timeline/views/_routesTimeline.html",restrict:"E",replace:!0}}angular.module("siurana.timeline").directive("routesTimeline",a),a.$inject=[]}(),function(){"use strict";function a(a,b,c,d,e,f){var g=this;g.getTypeColor=function(a){return e.getTypeColor({type:a.mainType})},g.getIconStatus=e.getIconStatus,g.getBadgeTooltip=function(a){return(a.isIndoor?"Indoor":"Outdoor")+" "+a.mainType},g.getBadgeIcon=function(a){return"fa "+(a.isIndoor?"fa-home":"fa-sun-o")},g.openRouteModal=function(a,c){b.open({templateUrl:"components/routes/views/sliderModal.html",controller:"ModalsliderCtrl",size:"md",resolve:{routesId:function(){var b=_.pluck(c,"id"),d=_.indexOf(b,a.id);return _.slice(b,d,b.length).concat(_.slice(b,0,d))}}})},g.addRoute=function(){b.open({templateUrl:"components/routes/views/_modalAddRoute.html",controller:"ModaladdrouteCtrl",size:"md"})},g.initController=function(a){var b=_.toArray(a),d=c.processData(b);g.events=d},g.initController(f),d.subscribeForUpdates(g.initController)}angular.module("siurana.timeline").controller("TimelineCtrl",a),a.$inject=["$log","$uibModal","timelineSvc","RoutesSvc","RoutesUtilsSvc","ResolvedRoutes"]}(),function(){"use strict";function a(a){var b={};return b.processData=function(b){var c,d=b.sort(function(a,b){return moment(b.date,"MM-DD-YYYY").unix()-moment(a.date,"MM-DD-YYYY").unix()}),e=_.reduce(d,function(a,b){b.location=b.location||"unknow",c!==b.location&&(a.push({areaLocation:b.location,routes:[]}),c=b.location);var d=_.last(a).routes;return d.push(b),a},[]);e=_.map(e,function(b){return b.sectors=_.map(a.arrayGroupBy(b.routes,"sector"),function(c){return b.routes.filter(function(a){return a.sector===c}).sort(function(b,c){return a.compareRouteGrade(c.grade,b.grade)})}),b}),e=_.map(e,function(a){return a.end=_.first(a.routes).date,a.start=_.last(a.routes).date,a});var f=_.map(e,function(b){var c=a.arrayGroupBy(b.routes,"type"),d=a.arrayGroupBy(b.routes,"rock");return delete b.routes,{mainType:_.first(c),isIndoor:"Indoor"===_.first(d),content:b}});return f},b}angular.module("siurana.timeline").service("timelineSvc",a),a.$inject=["utilsChartSvc"]}(),function(){"use strict";function a(a,b,c){return{restrict:"E",templateUrl:"components/users/views/_profileSummary.html",link:function(a){a.initDirective=function(){var d=c.getSession().uid||"none";a.profile={name:"Climbing Memo"},b.getProfile(d).then(function(b){a.profile=b.data})},a.initDirective()}}}angular.module("siurana.users").directive("profileSummary",a),a.$inject=["$rootScope","UsersSvc","Auth"]}(),function(){"use strict";function a(a,b,c){return{restrict:"E",templateUrl:"components/users/views/_userLogin.html",link:function(d){d.signIn=function(c){switch(c){case"google":a.googleSignIn().then(function(a){d.initDirective(),b.success("Welcome "+a.name)})["catch"](function(){b.error("Authentication failed")})}},d.logOut=a.logOut,d.initDirective=function(){d.isLoggedIn=c.isLoggedIn,d.name=c.getSession().name},d.initDirective()}}}angular.module("siurana.users").directive("userLogin",a),a.$inject=["UserLoginSvc","notificationService","Auth"]}(),function(){"use strict";function a(a,b,c,d,e,f){var g={};return g.firebase=new Firebase(f.url),g.successLogin=function(a,b){e.createSession(a),d.updateProfile(a.uid,b),c.path("/timeline")},g.logOut=function(){e.deleteSession(),g.firebase.unauth(),c.path("/")},g.oauthSuccessCallback=function(b,c,d){if(b)a.debug("Google authentication failed"),d.reject(b);else{var e=c.provider,f={uid:c.uid,token:c.token,expires:c.expires,provider:c.provider,name:c[e].displayName},h={uid:c.uid,provider:c.provider,id:c[e].id,email:c[e].email,name:c[e].displayName,picture:c[e].profileImageURL,link:c[e].cachedUserProfile.link,locale:c[e].cachedUserProfile.locale};Firebase.goOffline(),d.resolve(h),g.successLogin(f,h)}},g.googleSignIn=function(){var a=b.defer();return g.firebase.authWithOAuthPopup("google",function(b,c){g.oauthSuccessCallback(b,c,a)},{scope:"email"}),a.promise},g}angular.module("siurana.users").service("UserLoginSvc",a),a.$inject=["$log","$q","$location","UsersSvc","Auth","APP_CONFIG"]}(),function(){"use strict";function a(a,b){var c={};return c.getUrl=function(a){return b.url+"users/"+a},c.getProfile=function(b){return a({method:"GET",url:c.getUrl(b+"/profile.json"),cache:!0})},c.updateProfile=function(b,d){return a.put(c.getUrl(b+"/profile.json"),d)},c}angular.module("siurana.users").service("UsersSvc",a),a.$inject=["$http","APP_CONFIG"]}(),function(){angular.module("siurana",["siurana.table","siurana.timeline","siurana.map","siurana.charts"]).run(["$templateCache",function(a){"use strict";a.put("components/charts/views/_gridCharts.html",'<div class="row"> <div class="col-md-6"> <!-- Panel Scatter plot --> <div class="panel panel-success"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa fa-star-o"></span> Sector quality</h3> </div> <div class="panel-body"> <scatter-plot-chart routes="routes"></scatter-plot-chart> </div> </div> </div> <div class="col-md-6"> <!-- Panel Vertical Chart --> <div class="panel panel-success"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa fa-bar-chart"></span> Climb quantity</h3> </div> <div class="panel-body"> <vertical-bar-chart routes="routes"></vertical-bar-chart> </div> </div> </div> </div> <div class="row"> <div class="col-md-6"> <!-- Panel Horizontal Chart --> <div class="panel panel-success"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa fa-bar-chart"></span> Favorite climb type difficulty</h3> </div> <div class="panel-body"> <horizontal-bar-chart routes="routes"></horizontal-bar-chart> </div> </div> </div> <div class="col-md-6"> <!-- Panel Treemap Chart --> <div class="panel panel-success"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa fa-th-large"></span> Climb diversity</h3> </div> <div class="panel-body"> <treemap-chart routes="routes"></treemap-chart> </div> </div> </div> </div>'),a.put("components/charts/views/_headerOverview.html",'<div class="panel panel-info overview"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa fa-calendar"></span> Overview</h3> </div> <div class="panel-body"> <overview-chart class="text-center" routes="routes"></overview-chart> <hr> <div class="metrics"> <table class="table table-bordered"> <tbody> <tr class="active"> <td class="text-center" style="width:33%"> <small class="text-muted">Number of Climbs</small><br> <b>{{metrics.count}} Total</b> </td> <td class="text-center" style="width:33%"> <small class="text-muted">Favorite climbing type</small><br> <b>{{metrics.favoriteType}}</b> </td> <td class="text-center" style="width:33%"> <small class="text-muted">Favorite climbing sector</small><br> <b>{{metrics.favoriteSector}}</b> </td> </tr> </tbody> </table> </div> </div> </div>'),a.put("components/charts/views/_sectorsMetrics.html",'<span ng-repeat="metric in metrics"> <i class="fa fa-map-o"></i> {{metric.rating}} <i class="fa fa-star"></i> <a style="cursor:pointer" title="Routes Details" ng-click="openRoutesModal(metric.routesId)"> {{metric.sector}} </a> <span class="badge">{{metric.count}}</span><br> </span>'),a.put("components/charts/views/_sliderCharts.html",'<div class="slider-unstyled slider-charts"> <uib-carousel> <uib-slide ng-repeat="slide in slides" active="slide.active"> <div class="panel panel-default panel-unstyled"> <div class="panel-heading"> <h3 class="panel-title"><span class="fa {{slide.icon}}"></span> {{slide.title}}</h3> </div> <div class="panel-body"> <div class="chart-{{slide.type}}"></div> </div> </div> </uib-slide> </uib-carousel> </div>'),a.put("components/core/views/_mainNavbar.html",'<nav class="navbar navbar-default"> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#/"><i class="fa fa-book"></i> Memo App</a> </div> <div class="navbar-collapse collapse navbar-responsive-collapse"> <ul class="nav navbar-nav"> <li ng-class="{ active: isActive(\'/timeline\')}" ng-if="isLoggedIn()"> <a href="#/timeline" data-toggle="collapse" data-target=".navbar-responsive-collapse.in"> <i class="fa fa fa-clock-o"></i> Timeline </a> </li> <li ng-class="{ active: isActive(\'/table\')}" ng-if="isLoggedIn()"> <a href="#/table" data-toggle="collapse" data-target=".navbar-responsive-collapse.in"> <i class="fa fa-table"></i> Table </a> </li> <li ng-class="{ active: isActive(\'/map\')}" ng-if="isLoggedIn()"> <a href="#/map" data-toggle="collapse" data-target=".navbar-responsive-collapse.in"> <i class="fa fa-globe"></i> Map </a> </li> <li ng-class="{ active: isActive(\'/charts\')}" ng-if="isLoggedIn()"> <a href="#/charts" data-toggle="collapse" data-target=".navbar-responsive-collapse.in"> <i class="fa fa-bar-chart"></i> Charts </a> </li> </ul> <div class="navbar-right"> <user-login></user-login> </div> </div> </div> </nav>'),a.put("components/map/views/_windowLocationMap.html",'<div class="gm-pro-popup windowLocationMap"> <h4><i class="fa fa-map-marker"></i> {{parameter.name}}</h4> <sectors-metrics metrics="parameter.metrics"></sectors-metrics> <br> <a href="https://www.google.com/maps/dir/Current+Location/{{ parameter.coords.latitude }}, {{ parameter.coords.longitude }}" target="_blank"> <i class="fa fa-car"></i> Get directions </a> </div>'),a.put("components/routes/views/_cardRoute.html",'<div class="card-header"> <div class="text-center actions"> <button uib-tooltip="Edit" ng-if="!route.$editMode" ng-click="editRoute(route)" tooltip-placement="bottom" class="btn btn-default" tooltip-animation="false"> <i class="fa fa-pencil text-info fa-lg"></i> </button> <button uib-tooltip="Delete" ng-if="!route.$editMode" ng-click="deleteRoute(route)" tooltip-placement="bottom" class="btn btn-default" tooltip-animation="false"> <i class="fa fa-trash text-danger fa-lg"></i> </button> <button uib-tooltip="Save" ng-if="route.$editMode" class="btn btn-default" ng-click="saveRoute(route)" tooltip-placement="bottom" tooltip-animation="false"> <i class="fa fa-check text-success fa-lg"></i> </button> <button uib-tooltip="Cancel" ng-if="route.$editMode" class="btn btn-default" ng-click="cancelEdit(route)" tooltip-placement="bottom" tooltip-animation="false"> <i class="fa fa-times text-danger fa-lg"></i> </button> </div> </div> <div class="card card-route"> <div class="front"> <div class="content"> <div class="main"> <route-summary route="route"></route-summary> </div> </div> </div> <!-- end front panel --> <div class="back"> <div class="content"> <div class="main"> <uib-tabset justified="true"> <uib-tab ng-repeat="tab in tabs" vertical="true"> <uib-tab-heading> <i class="fa fa-{{tab.icon}}"></i> <span class="hidden-xs">{{tab.text}}</span> </uib-tab-heading> <div class="panel panel-default"> <div class="panel-body"> <div ng-switch="tab.type"> <route-notes route="route" ng-switch-when="notes"></route-notes> <route-media route="route" ng-switch-when="media"></route-media> <route-ascents route="route" ng-switch-when="ascents"></route-ascents> <route-builder route="route" ng-switch-when="builder"></route-builder> </div> </div> </div> </uib-tab> </uib-tabset> </div> </div> </div> <!-- end back panel --> </div> <!-- end card -->'),a.put("components/routes/views/_markdownReference.html",'<h2>Headers</h2> <pre><code># Level one header #</code></pre> <pre><code>### Level three header ###</code></pre> <p>Headers continue as you&#8217;d imagine, with extra hashes.</p> <h2>Links</h2> <div class="row"> <div class="col-md-6"> <pre><code>[This is a link](http://cmizony.com)</code></pre> </div> <div class="col-md-6"> <p><a href="http://cmizony.com">This is a link</a></p> </div> </div> <h2>Blockquote</h2> <div class="row"> <div class="col-md-6"> <pre><code>&gt; This is quoted\n</code></pre> </div> <div class="col-md-6"> <blockquote> <p>This is quoted</p> </blockquote> </div> </div> <h2>Code</h2> <div class="row"> <div class="col-md-6"> <pre><code>Inline code is `escaped` with backticks</code></pre> </div> <div class="col-md-6"> <p>Inline code is <code>escaped</code> with backticks</p> </div> </div> <h2>BlockCode</h2> <div class="row"> <div class="col-md-6"> <pre><code>```\nBlockcode is inside three backticks\n```</code></pre> </div> <div class="col-md-6"> <pre>Blockcode in inside three backticks</pre> </div> </div> <h2>Lists</h2> <div class="row"> <div class="col-md-6"> <pre><code>* This\n* is\n* a list</code></pre> </div> <div class="col-md-6"> <ul> <li>This</li> <li>is</li> <li>a list</li> </ul> </div> </div> <div class="row"> <div class="col-md-6"> <pre><code>1. with\n1. numbers</code></pre> </div> <div class="col-md-6"> <ol> <li>with</li> <li>numbers</li> </ol> </div> </div> <h2>Horizontal lines</h2> <div class="row"> <div class="col-md-6"> <p>Three or more dashes</p> <pre><code>---- </code></pre> </div> <div class="col-md-6"> <hr> </div> </div> <h2>Emphasis</h2> <div class="row"> <div class="col-md-6"> <pre><code>_italic_ or *italic*</code></pre> </div> <div class="col-md-6"> <p><em>italic</em> or <em>italic</em></p> </div> </div> <div class="row"> <div class="col-md-6"> <pre><code>__bold__ or **bold**</code></pre> </div> <div class="col-md-6"> <p><strong>bold</strong> or <strong>bold</strong></p> </div> </div> <h2>Escaping</h2> <div class="row"> <div class="col-md-6"> <pre><code>This is \\*\\*not\\*\\* in bold.</code></pre> </div> <div class="col-md-6"> <p>This is &#42;&#42;not&#42;&#42; in bold.</p> </div> </div> <h2>More markdown</h2> <p>See full <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank" class="external">Markdown syntax</a></p>'),a.put("components/routes/views/_markdownReferenceSummary.html",'<pre>\n  <code># Level one header #</code>\n  <code>### Level three header ###</code>\n  <code>[This is a link](http://cmizony.com)</code>\n  <code>![alt description](http://cmizony.com/img/technologies/d3js.png)</code>\n  <code>&gt; This is quoted\n  </code>\n  <code>Inline code is `escaped` with backticks</code>\n  <code>```\n  Blockcode is inside three backticks\n  ```</code>\n  <code>* This\n  * is\n  * a list</code>\n  <code>1. with\n  1. numbers</code>\n  <code>---- </code>\n  <code>_italic_ or *italic*</code>\n  <code>__bold__ or **bold**</code>\n  <code>This is \\*\\*not\\*\\* in bold.</code>\n</pre> <p>See full <a href="http://daringfireball.net/projects/markdown/syntax" target="_blank" class="external">Markdown syntax</a></p>'),a.put("components/routes/views/_modalAddRoute.html",'<div class="route-modal"> <div class="modal-body"> <div> <div class="card-container manual-flip" ng-class="{hover: route.$hover}"> <card-route></card-route> </div> <div class="modal-footer"> <button class="btn btn-success" ng-click="flipCard()"><i class="fa fa-undo fa-flip-vertical"></i> Flip</button> <button class="btn btn-primary" ng-click="cancelEdit()"><i class="fa fa-times"></i></button> </div> </div> </div> </div>'),a.put("components/routes/views/_routeAscents.html",'<div class="alert alert-dismissible alert-info"> Ascents routes not yet implemented </div>'),a.put("components/routes/views/_routeBuilder.html",'<div class="alert alert-dismissible alert-info"> Routes builder not yet implemented </div>'),a.put("components/routes/views/_routeMedia.html",'<div class="text-left"> <div ng-if="!route.$editMode"> <div ng-if="medias.length === 0"> <div class="panel-body"> <div class="row"> <div class="col-xs-3"> <span class="fa-stack fa-2x text-muted"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-camera fa-stack-1x fa-inverse"></i> </span> </div> <div class="col-xs-9"> <b>No medias</b> <i class="fa fa-lg fa-youtube text-danger" uib-tooltip="Youtube"></i>&nbsp; <i class="fa fa-lg fa-instagram text-primary" uib-tooltip="Instagram"></i>&nbsp; <i class="fa fa-lg fa-vimeo text-success" uib-tooltip="Vimeo"></i>&nbsp; <i class="fa fa-lg fa-flickr" uib-tooltip="Flickr"></i> <p style="margin-top:7px" class="text-muted"> Edit route to add external links </p> </div> </div> </div> </div> <div ng-repeat="media in medias" class="route-media panel panel-default"> <div ng-if="isValidMedia(media.link)" class="panel-body" ng-click="openMedia(media)"> <div class="row"> <div class="col-xs-3"> <i class="fa fa-3x fa-fw fa-{{media.provider}} {{media.color}}"></i> </div> <div class="col-xs-9"> <b>{{media.header}}</b> <p class="visible-xs text-muted">{{media.link | prettyUrl:20}}</p> <p class="hidden-xs text-muted">{{media.link | prettyUrl:50}}</p> </div> </div> </div> </div> </div> <div ng-if="route.$editMode"> <div ng-repeat="link in newMedias track by $index" class="route-media-edit panel panel-default"> <div class="panel-body"> <div class="row"> <div class="col-xs-3"> <i class="fa fa-3x fa-fw fa-{{getMedia(link).provider}} {{getMedia(link).color}}"></i> </div> <div class="col-xs-9"> <div class="input-group" ng-if="!getMedia(link).header"> <div class="input-group-addon"> <i class="fa fa-lg fa-plus" uib-tooltip="Accepted sites"></i> </div> <i class="fa fa-lg fa-youtube text-danger" uib-tooltip="Youtube"></i>&nbsp; <i class="fa fa-lg fa-instagram text-primary" uib-tooltip="Instagram"></i>&nbsp; <i class="fa fa-lg fa-vimeo text-success" uib-tooltip="Vimeo"></i>&nbsp; <i class="fa fa-lg fa-flickr" uib-tooltip="Flickr"></i> </div> <b>{{getMedia(link).header}}</b> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-globe"></i> </div> <input type="url" ng-model="newMedias[$index]" class="form-control" placeholder="URL"> </div> </div> </div> </div> </div> <div ng-repeat="media in medias" class="route-media-edit panel panel-default"> <div ng-if="isValidMedia(media.link)" class="panel-body"> <div class="row"> <div class="col-xs-3"> <button uib-tooltip="Delete media link" ng-click="deleteMedia(media.link)" tooltip-placement="bottom" class="btn btn-default ng-scope" tooltip-animation="false"> <i class="fa fa-trash text-danger fa-2x"></i> </button> </div> <div class="col-xs-9"> <i class="fa fa-lg fa-fw fa-{{media.provider}} {{media.color}}"></i> <b>{{media.header}}</b> <p class="visible-xs text-muted">{{media.link | prettyUrl:20}}</p> <p class="hidden-xs text-muted">{{media.link | prettyUrl:50}}</p> </div> </div> </div> </div> </div> </div>'),a.put("components/routes/views/_routeNotes.html",'<div ng-if="!route.$editMode"> <div marked="route.notes"></div> </div> <div ng-if="route.$editMode"> <uib-tabset type="pills"> <uib-tab> <uib-tab-heading> <span style="cursor:pointer"><i class="fa fa-pencil-square-o"></i> <span class="hidden-xs">Markdown</span></span> </uib-tab-heading> <textarea rows="12" ng-trim="false" maxlength="2000" class="form-control" ng-model="route.notes"></textarea> <span class="text-muted" ng-show="route.notes.length > 1000"> <i class="fa fa-pencil"></i> {{2001 - route.notes.length - route.notes.split("\\n").length}} characters left </span> </uib-tab> <uib-tab> <uib-tab-heading> <span style="cursor:pointer"><i class="fa fa-search"></i> <span class="hidden-xs">Preview</span></span> </uib-tab-heading> <div marked="route.notes"></div> </uib-tab> <uib-tab> <uib-tab-heading> <span style="cursor:pointer"><i class="fa fa-question-circle"></i> <span class="hidden-xs">Help</span></span> </uib-tab-heading> <div class="hidden-xs hidden-sm" ng-include src="\'components/routes/views/_markdownReference.html\'"></div> <div class="visible-xs visible-sm" ng-include src="\'components/routes/views/_markdownReferenceSummary.html\'"></div> </uib-tab> </uib-tabset> </div>'),a.put("components/routes/views/_routeSummary.html",'<div ng-if="!route.$editMode"> <span class="fa-stack fa-3x" uib-tooltip="{{getIndoorLabel(route)}} {{route.type}}" tooltip-placement="bottom"> <i class="fa fa-circle fa-stack-2x" style="color:{{getTypeColor(route)}}"></i> <i class="fa {{getIconRock(route)}} fa-stack-1x fa-inverse"></i> </span> <h3 class="name"> {{ route.name }} <i ng-if="route.$sync" class="fa fa-refresh text-info" uib-tooltip="Offline {{route.$sync}}"></i> </h3> <div class="header"> <span>- {{ route.grade }} -</span> <div class="rating"> <span ng-repeat="t in getTimes(route.rating) track by $index"> <i class="fa fa-star"></i> </span> <span class="hidden-xs" ng-repeat="t in getTimes(5 - route.rating) track by $index"> <i class="fa fa-star-o"></i> </span> </div> </div> <h5><i class="fa fa-map-marker fa-fw text-muted"></i> {{route.location}}</h5> <h5><i class="fa fa-map-o fa-fw text-muted"></i> {{route.sector}}</h5> <h5><i class="fa fa-calendar-o fa-fw text-muted"></i> {{route.date}}</h5> <h5><i class="fa {{getIconRock(route)}} fa-fw text-muted"></i> {{route.rock}} </h5> <h5><i class="fa {{getIconStatus(route)}} fa-fw text-muted"></i> {{route.status}} </h5> </div> <div ng-if="route.$editMode"> <form name="form" novalidate> <span class="fa-stack fa-3x"> <i class="fa fa-circle fa-stack-2x" style="color:{{getTypeColor(route)}}"></i> <i class="fa {{getIconRock(route)}} fa-stack-1x fa-inverse"></i> </span> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-fw" uib-tooltip="{{ form.name.$error.required ?  \'Name is required\' : \'\' }}" ng-class="{\n            \'fa-pencil\'           : !form.name.$pending,\n            \'fa-spinner fa-pulse\' : form.name.$pending,\n            \'text-muted\'          : form.name.$pristine,\n            \'text-success\'        : form.name.$valid && form.name.$dirty,\n            \'text-danger\'         : form.name.$invalid && form.name.$dirty,\n          }"></i> </div> <input name="name" autocomplete="off" placeholder="Name" class="form-control" type="required" required ng-model="route.name"> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-user fa-fw" ng-class="{\n            \'text-muted\' :    form.grade.$pristine,\n            \'text-success\' :  form.grade.$valid && form.grade.$dirty,\n            \'text-danger\' :   form.grade.$invalid && form.grade.$dirty,\n          }"></i> </div> <input placeholder="Grade" autocomplete="off" class="form-control" type="text" name="grade" ng-model="route.grade"> </div> <uib-rating ng-model="route.rating" state-on="\'fa fa-star fa-lg\'" state-off="\'fa fa-star-o fa-lg\'"></uib-rating> <div class="input-group"> <div class="input-group-addon"> <i class="fa {{getIconStatus(route)}} fa-fw" ng-class="{\n            \'text-muted\' :    form.status.$pristine,\n            \'text-success\' :  form.status.$valid && form.status.$dirty,\n            \'text-danger\' :   form.status.$invalid && form.status.$dirty,\n          }"></i> </div> <select class="form-control" name="status" ng-model="route.status"> <option>Attempt</option> <option>Redpoint</option> <option>Flash</option> <option>Onsight</option> </select> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-calendar-o fa-fw" ng-class="{\n            \'text-muted\' :    form.date.$pristine,\n            \'text-success\' :  form.date.$valid && form.date.$dirty,\n            \'text-danger\' :   form.date.$invalid && form.date.$dirty,\n          }"></i> </div> <input type="date" class="form-control" required name="date" ng-model="route.$date"> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-map-o fa-fw" ng-class="{\n            \'text-muted\' :    form.sector.$pristine,\n            \'text-success\' :  form.sector.$valid && form.sector.$dirty,\n            \'text-danger\' :   form.sector.$invalid && form.sector.$dirty,\n          }"></i> </div> <input placeholder="Sector" autocomplete="off" uib-typeahead="sector for sector in sectors | filter:$viewValue" typeahead-on-select="sectorPopulatePlaceholder($item,route)" class="form-control" type="text" name="sector" ng-model="route.sector"> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-connectdevelop fa-fw" ng-class="{\n            \'text-muted\' :    form.type.$pristine,\n            \'text-success\' :  form.type.$valid && form.type.$dirty,\n            \'text-danger\' :   form.type.$invalid && form.type.$dirty,\n          }"></i> </div> <select class="form-control" ng-model="route.type" name="type"> <option>Sport lead</option> <option>Boulder</option> <option>Traditional</option> <option>Multi-pitch</option> <option>Top rope</option> </select> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa {{getIconRock(route)}} fa-fw" ng-class="{\n            \'text-muted\' :    form.rock.$pristine,\n            \'text-success\' :  form.rock.$valid && form.rock.$dirty,\n            \'text-danger\' :   form.rock.$invalid && form.rock.$dirty,\n          }"></i> </div> <select class="form-control" ng-model="route.rock" name="rock"> <option>Granite</option> <option>Sandstone</option> <option>Limestone</option> <option>Indoor</option> <option>Conglomerate</option> <option>Basalt</option> <option>Volcanic</option> </select> </div> <div class="input-group"> <div class="input-group-addon"> <i class="fa fa-map-marker fa-fw" uib-tooltip="{{ form.location.$error.routeLocation ? \'Sorry, location not found\' : \'\' }}" ng-class="{\n            \'fa-pencil\'           : !form.location.$pending,\n            \'fa-spinner fa-pulse\' : form.location.$dirty && form.location.$pending,\n            \'text-muted\' :    form.location.$pristine,\n            \'text-success\' :  form.location.$valid && form.location.$dirty,\n            \'text-danger\' :   form.location.$invalid && form.location.$dirty,\n          }"></i> </div> <input placeholder="Location" class="form-control" name="location" type="text" route-location ng-model-options="{ debounce: 500 }" ng-model="route.location" autocomplete="off" uib-typeahead="location for location in locations | filter:$viewValue">  </div> </form> </div>'),
a.put("components/routes/views/sliderModal.html",'<div class="modal-unstyled slider-unstyled"> <div class="modal-body"> <div> <uib-carousel interval="myInterval" no-wrap="noWrapSlides"> <uib-slide ng-repeat="slide in slides" active="slide.active"> <div class="card-container manual-flip" ng-class="{hover: slide.$hover}" ng-init="route = slide.content"> <card-route></card-route> </div> </uib-slide> </uib-carousel> </div> </div> <div class="modal-footer"> <button class="btn btn-success" ng-click="flipCard()"> <i class="fa fa-undo fa-flip-vertical"></i> Flip </button> <button class="btn btn-primary" ng-click="closeModal()"> <i class="fa fa-times"></i> </button> </div> </div>'),a.put("components/table/views/_routesTable.html",'<p class="hidden-xs"> <button uib-tooltip="Add route" class="btn btn-fab btn-raised btn-success" ng-click="tableVm.addRoute()"><i class="fa fa-plus"></i></button> </p> <div ng-swipe-left="tableVm.nextPage()" ng-swipe-right="tableVm.previousPage()"> <table data-datatable="ng" data-dt-options="tableVm.dtOptions" dt-instance="tableVm.dtInstance" class="table table-condensed table-hover"> <thead> <tr> <th class="">Name</th> <th class="">Grade</th> <th class="hidden-xs hidden-sm">Rating</th> <th class="hidden-xs">Status</th> <th class="hidden-xs">Date</th> <th class="">Sector</th> <th class="hidden-xs">Type</th> <th class="hidden-xs hidden-sm">Rock</th> <th class="hidden-xs">Location</th> </tr> </thead> <tbody> <tr ng-repeat="route in tableVm.routes" ng-click="tableVm.openRouteModal(route)" style="cursor:pointer"> <td> <i class="fa {{tableVm.getIconStatus(route)}} text-muted"></i> <a title="Route Details"> {{route.name}} </a> <i ng-if="route.$sync" class="fa fa-refresh text-info" uib-tooltip="Offline {{route.$sync}}"></i> </td> <td class=""> <span>{{route.grade}}</span> </td> <td class="hidden-xs hidden-sm"> <uib-rating readonly ng-model="route.rating"></uib-rating> </td> <td class="hidden-xs"> <span>{{route.status}}</span> </td> <td class="hidden-xs"> <span>{{route.date}}</span> </td> <td class=""> <span>{{route.sector}}</span> </td> <td class="hidden-xs"> <span class="label label-success" style="background-color:{{getTypeColor(route)}}"> {{route.type}} </span> </td> <td class="hidden-xs hidden-sm"> <span>{{route.rock}}</span> </td> <td class="hidden-xs"> <span>{{route.location}}</span> </td> </tr> </tbody> </table> </div>'),a.put("components/timeline/views/_routesTimeline.html",'<div> <timeline> <timeline-event ng-repeat="event in timelineVm.events"> <timeline-badge style="background-color:{{ timelineVm.getTypeColor(event) }}" uib-tooltip="{{ timelineVm.getBadgeTooltip(event) }}"> <i class="fa {{ timelineVm.getBadgeIcon(event) }}"></i> </timeline-badge> <timeline-panel> <timeline-heading> <h4><i class="fa fa-map-marker"></i> {{event.content.areaLocation}}</h4> <p> <small class="text-muted"> <span class="hidden-xs"> <i class="fa fa-calendar"></i> From {{event.content.start }} to {{event.content.end}}</span> <span class="visible-xs"> {{event.content.start | date:\'shortdate\' }} to {{event.content.end | date:\'shortdate\'}} </span> </small> </p> </timeline-heading> <div ng-repeat="routes in event.content.sectors"> <p> <i class="fa fa-map-o"></i> {{ routes[0].sector }} <span class="badge">{{ routes.length }}</span> </p> <span ng-repeat="route in routes"> <i class="fa {{timelineVm.getIconStatus(route)}} text-muted"></i> <span class="text-muted">{{route.grade}}</span> <a style="cursor:pointer" title="Route Details" ng-click="timelineVm.openRouteModal(route, routes)"> {{route.name}} </a> <i ng-if="route.$sync" class="fa fa-refresh text-info" uib-tooltip="Offline {{route.$sync}}"></i> <br> </span> </div> </timeline-panel> </timeline-event> </timeline> </div>'),a.put("components/users/views/_profileSummary.html",'<div class="panel panel-default"> <div class="panel-body text-center"> <div class="hidden-sm"> <img ng-if="profile.picture" width="112" height="112" alt="Profile picture" class="img-circle" ng-src="{{profile.picture}}"> <span ng-if="!profile.picture" class="fa-stack fa-4x"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-book fa-stack-1x fa-inverse"></i> </span> <h3> {{ profile.name }} </h3> <hr> <ul class="list-unstyled"> <li ng-if="profile.email"> <i class="fa fa-fw fa-envelope-o"></i> <a href="mailto:{{profile.email}}">{{ profile.email }}</a> </li> <li ng-if="profile.provider"> <i class="fa fa-fw fa-{{ profile.provider }}"></i> <a ng-href="{{ profile.link  }}" target="_blank"> {{ profile.name }} </a> </li> </ul> </div> <div class="visible-sm"> <div class="row"> <div class="col-sm-3"> <img ng-if="profile.picture" width="112" height="112" class="img-circle" alt="Profile picture" ng-src="{{profile.picture}}"> <span ng-if="!profile.picture" class="fa-stack fa-4x"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-book fa-stack-1x fa-inverse"></i> </span> </div> <div class="col-sm-9"> <h3> {{ profile.name }} </h3> <ul class="list-unstyled"> <li ng-if="profile.email"> <i class="fa fa-fw fa-envelope-o"></i> <a href="mailto:{{profile.email}}">{{ profile.email }}</a> </li> <li ng-if="profile.provider"> <i class="fa fa-fw fa-{{ profile.provider }}"></i> <a ng-href="{{ profile.link  }}" target="_blank"> {{ profile.name }} </a> </li> </ul> </div> </div> </div> </div> </div>'),a.put("components/users/views/_userLogin.html",'<div ng-if="!isLoggedIn()"> <ul class="nav navbar-nav"> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-sign-in"></i> Log In <span class="caret"></span> </a> <ul class="dropdown-menu"> <li> <a href="" ng-click="signIn(\'google\')"> <i class="fa fa-fw fa-google text-danger"></i>Google</a> </li> <li class="disabled"> <a href=""> <i class="fa fa-fw fa-twitter text-info"></i>Twitter</a> </li> <li class="disabled"> <a href=""> <i class="fa fa-fw fa-facebook text-info"></i>Facebook</a> </li> </ul> </li> </ul> </div> <div ng-if="isLoggedIn()"> <ul class="nav navbar-nav"> <li class="dropdown"> <a href="" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="fa fa-user"></i> {{name}} <span class="caret"></span> <ul class="dropdown-menu"> <li> <a href="" ng-click="logOut()"> <i class="fa fa-fw fa-sign-out"></i> Log out</a> </li> </ul> </a></li> </ul> </div>')}])}();